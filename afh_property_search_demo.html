<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AFH Property Search Demo - Property Matching Service</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a2f1a 0%, #2d4a2d 50%, #1a2f1a 100%);
            color: #e6f4e6;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            padding: 40px 20px;
            background: rgba(0, 0, 0, 0.4);
            border-bottom: 2px solid #00ff00;
        }
        
        .header h1 {
            color: #00ff00;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }
        
        .header p {
            font-size: 1.2rem;
            color: #b3e6b3;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .search-section {
            background: rgba(0, 0, 0, 0.3);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #00ff00;
        }
        
        .search-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            color: #00ff00;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid #00ff00;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.5);
            color: #e6f4e6;
            font-size: 1rem;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #00ff88;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
        }
        
        .search-button {
            background: linear-gradient(45deg, #00ff00, #00ff88);
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            grid-column: 1 / -1;
            justify-self: center;
            width: 200px;
        }
        
        .search-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 0, 0.4);
        }
        
        .results-section {
            background: rgba(0, 0, 0, 0.3);
            padding: 30px;
            border-radius: 15px;
            border: 1px solid #00ff00;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #00ff00;
        }
        
        .results-count {
            color: #00ff00;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .sort-options {
            display: flex;
            gap: 10px;
        }
        
        .sort-button {
            background: rgba(0, 255, 0, 0.2);
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .sort-button:hover,
        .sort-button.active {
            background: #00ff00;
            color: #000;
        }
        
        .property-card {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .property-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 255, 0, 0.2);
            border-color: #00ff88;
        }
        
        .property-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .property-address {
            color: #00ff00;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .afh-score {
            background: linear-gradient(45deg, #00ff00, #00ff88);
            color: #000;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .property-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .detail-item {
            display: flex;
            flex-direction: column;
        }
        
        .detail-label {
            color: #b3e6b3;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }
        
        .detail-value {
            color: #e6f4e6;
            font-weight: bold;
        }
        
        .property-features {
            margin-bottom: 15px;
        }
        
        .features-title {
            color: #00ff00;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .features-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .feature-tag {
            background: rgba(0, 255, 0, 0.2);
            color: #00ff00;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
            border: 1px solid #00ff00;
        }
        
        .property-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .action-button {
            padding: 10px 20px;
            border: 1px solid #00ff00;
            border-radius: 5px;
            background: transparent;
            color: #00ff00;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .action-button:hover {
            background: #00ff00;
            color: #000;
        }
        
        .action-button.primary {
            background: #00ff00;
            color: #000;
        }
        
        .action-button.primary:hover {
            background: #00ff88;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #00ff00;
            font-size: 1.2rem;
        }
        
        .no-results {
            text-align: center;
            padding: 40px;
            color: #b3e6b3;
            font-size: 1.1rem;
        }
        
        .afh-potential-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .afh-potential-excellent {
            background: #00ff00;
            color: #000;
        }
        
        .afh-potential-high {
            background: #00ff88;
            color: #000;
        }
        
        .afh-potential-medium {
            background: #ffaa00;
            color: #000;
        }
        
        .afh-potential-low {
            background: #ff4444;
            color: #fff;
        }
        
        @media (max-width: 768px) {
            .search-form {
                grid-template-columns: 1fr;
            }
            
            .property-header {
                flex-direction: column;
                gap: 10px;
            }
            
            .property-details {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .property-actions {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üè† AFH Property Search Demo</h1>
        <p>Find the perfect property for your Adult Family Home business</p>
    </div>
    
    <div class="container">
        <div class="search-section">
            <h2 style="color: #00ff00; margin-bottom: 20px;">üîç Search Properties</h2>
            <form class="search-form" id="searchForm">
                <div class="form-group">
                    <label for="county">County</label>
                    <select id="county" name="county">
                        <option value="">All Counties</option>
                        <option value="King">King County</option>
                        <option value="Pierce">Pierce County</option>
                        <option value="Thurston">Thurston County</option>
                        <option value="Lewis">Lewis County</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="minPrice">Min Price</label>
                    <input type="number" id="minPrice" name="minPrice" placeholder="e.g., 300000">
                </div>
                
                <div class="form-group">
                    <label for="maxPrice">Max Price</label>
                    <input type="number" id="maxPrice" name="maxPrice" placeholder="e.g., 600000">
                </div>
                
                <div class="form-group">
                    <label for="minBeds">Min Bedrooms</label>
                    <select id="minBeds" name="minBeds">
                        <option value="">Any</option>
                        <option value="3">3+</option>
                        <option value="4">4+</option>
                        <option value="5">5+</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="minBaths">Min Bathrooms</label>
                    <select id="minBaths" name="minBaths">
                        <option value="">Any</option>
                        <option value="2">2+</option>
                        <option value="3">3+</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="afhScore">Min AFH Score</label>
                    <select id="afhScore" name="afhScore">
                        <option value="">Any</option>
                        <option value="70">70+</option>
                        <option value="80">80+</option>
                        <option value="90">90+</option>
                    </select>
                </div>
                
                <button type="submit" class="search-button">üîç Search Properties</button>
            </form>
        </div>
        
        <div class="results-section">
            <div class="results-header">
                <div class="results-count" id="resultsCount">Loading properties...</div>
                <div class="sort-options">
                    <button class="sort-button active" data-sort="afh_score">AFH Score</button>
                    <button class="sort-button" data-sort="price">Price</button>
                    <button class="sort-button" data-sort="beds">Bedrooms</button>
                </div>
            </div>
            
            <div id="resultsContainer">
                <div class="loading">‚è≥ Loading properties...</div>
            </div>
        </div>
    </div>
    
    <script>
        // Global variables
        let allProperties = [];
        let filteredProperties = [];
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadProperties();
            setupEventListeners();
        });
        
        // Load properties from API
        async function loadProperties() {
            try {
                const response = await fetch('/api/properties');
                allProperties = await response.json();
                filteredProperties = [...allProperties];
                displayProperties();
                updateResultsCount();
            } catch (error) {
                console.error('Error loading properties:', error);
                document.getElementById('resultsContainer').innerHTML = 
                    '<div class="no-results">‚ùå Error loading properties. Please try again.</div>';
            }
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Search form
            document.getElementById('searchForm').addEventListener('submit', function(e) {
                e.preventDefault();
                filterProperties();
            });
            
            // Sort buttons
            document.querySelectorAll('.sort-button').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.sort-button').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    sortProperties(this.dataset.sort);
                });
            });
        }
        
        // Filter properties based on search criteria
        function filterProperties() {
            const formData = new FormData(document.getElementById('searchForm'));
            const filters = Object.fromEntries(formData.entries());
            
            filteredProperties = allProperties.filter(property => {
                // County filter
                if (filters.county && property.county !== filters.county) {
                    return false;
                }
                
                // Price filters
                if (filters.minPrice && property.price < parseInt(filters.minPrice)) {
                    return false;
                }
                if (filters.maxPrice && property.price > parseInt(filters.maxPrice)) {
                    return false;
                }
                
                // Bedroom filter
                if (filters.minBeds && property.beds < parseInt(filters.minBeds)) {
                    return false;
                }
                
                // Bathroom filter
                if (filters.minBaths && property.baths < parseInt(filters.minBaths)) {
                    return false;
                }
                
                // AFH Score filter
                if (filters.afhScore && property.afh_score < parseInt(filters.afhScore)) {
                    return false;
                }
                
                return true;
            });
            
            displayProperties();
            updateResultsCount();
        }
        
        // Sort properties
        function sortProperties(sortBy) {
            filteredProperties.sort((a, b) => {
                switch (sortBy) {
                    case 'afh_score':
                        return b.afh_score - a.afh_score;
                    case 'price':
                        return a.price - b.price;
                    case 'beds':
                        return b.beds - a.beds;
                    default:
                        return 0;
                }
            });
            
            displayProperties();
        }
        
        // Display properties
        function displayProperties() {
            const container = document.getElementById('resultsContainer');
            
            if (filteredProperties.length === 0) {
                container.innerHTML = '<div class="no-results">üîç No properties found matching your criteria.</div>';
                return;
            }
            
            container.innerHTML = filteredProperties.map(property => `
                <div class="property-card">
                    <div class="property-header">
                        <div class="property-address">
                            ${property.address}
                            <span class="afh-potential-badge afh-potential-${property.afh_potential.toLowerCase()}">
                                ${property.afh_potential}
                            </span>
                        </div>
                        <div class="afh-score">${property.afh_score}/100</div>
                    </div>
                    
                    <div class="property-details">
                        <div class="detail-item">
                            <span class="detail-label">Price</span>
                            <span class="detail-value">$${property.price.toLocaleString()}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Bedrooms</span>
                            <span class="detail-value">${property.beds}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Bathrooms</span>
                            <span class="detail-value">${property.baths}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Square Feet</span>
                            <span class="detail-value">${property.sqft.toLocaleString()}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Lot Size</span>
                            <span class="detail-value">${property.lot_size.toLocaleString()} sq ft</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Year Built</span>
                            <span class="detail-value">${property.year_built}</span>
                        </div>
                    </div>
                    
                    <div class="property-features">
                        <div class="features-title">üè† AFH Features:</div>
                        <div class="features-list">
                            ${property.features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                        </div>
                    </div>
                    
                    <div class="property-actions">
                        <a href="${property.listing_url}" class="action-button" target="_blank">View Listing</a>
                        <button class="action-button primary" onclick="analyzeProperty(${property.id})">Analyze AFH Potential</button>
                    </div>
                </div>
            `).join('');
        }
        
        // Update results count
        function updateResultsCount() {
            const count = filteredProperties.length;
            const total = allProperties.length;
            document.getElementById('resultsCount').textContent = 
                `Found ${count} properties${count !== total ? ` (filtered from ${total} total)` : ''}`;
        }
        
        // Analyze property AFH potential
        function analyzeProperty(propertyId) {
            const property = allProperties.find(p => p.id === propertyId);
            if (!property) return;
            
            // In a real application, this would make an API call to get detailed analysis
            alert(`AFH Analysis for ${property.address}:\n\n` +
                  `AFH Score: ${property.afh_score}/100\n` +
                  `Potential: ${property.afh_potential}\n\n` +
                  `Key Features:\n${property.features.join('\n')}\n\n` +
                  `Estimated Conversion Cost: $15,000\n` +
                  `Estimated ROI: $285,000\n\n` +
                  `This property shows excellent potential for AFH conversion!`);
        }
    </script>
</body>
</html>
